<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User List</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  <link rel="stylesheet" href="styles.css">
     
    <!----===== Iconscout CSS ===== -->
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container mt-3 mb-4">
    <div class="col-lg-9 mt-4 mt-lg-0">
      <div class="row">
        <div class="col-md-12">
          <div class="user-dashboard-info-box table-responsive mb-0 bg-white p-4 shadow-sm">
            <table class="table manage-candidates-top mb-0">
              <thead>
                <tr>
                  <th>Users Profile</th>
                  <th class="text-center">Role</th>
                  <th class="action text-right">Action</th>
                </tr>
              </thead>
              <tbody>
                <!-- User data will be rendered here -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal for editing user profile -->
  <div class="modal fade" id="profileModal" tabindex="-1" aria-labelledby="profileModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <!-- Modal Header -->
        <div class="modal-header">
          <h5 class="modal-title" id="profileModalLabel">Profile</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <!-- Modal Body -->
        <div class="modal-body">
          <!-- Modal content for editing user profile -->
        </div>
        <!-- Modal Footer -->
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <script>


// Function to fetch users from the API
async function fetchUsers() {
    try {
      const response = await fetch('https://policy-link-rwanda-client-project-with.onrender.com/account/view_all_users/');
      const data = await response.json();
      return data;
    } catch (error) {
      console.error('Error fetching users:', error);
      return [];
    }
  }
  
  // Function to render user data in the table
  function renderUserData(users) {
    const tableBody = document.querySelector('table tbody');
    tableBody.innerHTML = '';
  
    users.forEach((user, index) => {
      const row = document.createElement('tr');
      row.classList.add('candidates-list');
  
      const titleCell = document.createElement('td');
      titleCell.classList.add('title');
  
      const thumbDiv = document.createElement('div');
      thumbDiv.classList.add('thumb');
  
      const detailsDiv = document.createElement('div');
      detailsDiv.classList.add('candidate-list-details');
  
      const infoDiv = document.createElement('div');
      infoDiv.classList.add('candidate-list-info');
  
      const titleDiv = document.createElement('div');
      titleDiv.classList.add('candidate-list-title');
  
      const nameLink = document.createElement('a');
      nameLink.href = '#';
      nameLink.textContent = `${user.firstname} ${user.lastname}`;
  
      const h5 = document.createElement('h5');
      h5.classList.add('mb-0');
      h5.appendChild(nameLink);
  
      titleDiv.appendChild(h5);
      infoDiv.appendChild(titleDiv);
  
      const optionDiv = document.createElement('div');
      optionDiv.classList.add('candidate-list-option');
  
      const optionUl = document.createElement('ul');
      optionUl.classList.add('list-unstyled');
  
      const departmentLi = document.createElement('li');
      departmentLi.innerHTML = `<i class="fas fa-filter pr-1"></i>${user.phone}`;
  
      const locationLi = document.createElement('li');
      locationLi.innerHTML = `<i class="fas fa-map-marker-alt pr-1"></i>${user.username}`;
  
      optionUl.appendChild(departmentLi);
      optionUl.appendChild(locationLi);
  
      optionDiv.appendChild(optionUl);
      infoDiv.appendChild(optionDiv);
  
      detailsDiv.appendChild(infoDiv);
      titleCell.appendChild(detailsDiv);
  
      const roleCell = document.createElement('td');
      roleCell.classList.add('candidate-list-favourite-time', 'text-center');
  
      const roleSpan = document.createElement('span');
      roleSpan.classList.add('candidate-list-time', 'order-1');
      roleSpan.textContent = user.role;
  
      roleCell.appendChild(roleSpan);
  
      const actionCell = document.createElement('td');
  
      const actionUl = document.createElement('ul');
      actionUl.classList.add('list-unstyled', 'mb-0', 'd-flex', 'justify-content-end');
  
      const viewLi = document.createElement('li');
      const viewLink = document.createElement('a');
      viewLink.href = '#';
      viewLink.classList.add('text-primary');
      viewLink.setAttribute('data-toggle', 'tooltip');
      viewLink.setAttribute('title', 'view');
      const viewIcon = document.createElement('i');
      viewIcon.classList.add('far', 'fa-eye');
      viewLink.appendChild(viewIcon);
      viewLi.appendChild(viewLink);
  
      const editLi = document.createElement('li');
      const editLink = document.createElement('a');
      editLink.href = '#';
      editLink.classList.add('text-info');
      editLink.setAttribute('data-toggle', 'tooltip');
      editLink.setAttribute('title', 'Edit');
      editLink.setAttribute('data-toggle', 'modal');
      editLink.setAttribute('data-target', '#profileModal');
      const editIcon = document.createElement('i');
      editIcon.classList.add('fas', 'fa-pencil-alt');
      editLink.appendChild(editIcon);
      editLi.appendChild(editLink);
  
      const deleteLi = document.createElement('li');
      const deleteLink = document.createElement('a');
      deleteLink.href = '#';
      deleteLink.classList.add('text-danger');
      deleteLink.setAttribute('data-toggle', 'tooltip');
      deleteLink.setAttribute('title', 'Delete');
      const deleteIcon = document.createElement('i');
      deleteIcon.classList.add('far', 'fa-trash-alt');
      deleteLink.appendChild(deleteIcon);
      deleteLi.appendChild(deleteLink);
  
      actionUl.appendChild(viewLi);
      actionUl.appendChild(editLi);
      actionUl.appendChild(deleteLi);
  
      actionCell.appendChild(actionUl);
  
      row.appendChild(titleCell);
      row.appendChild(roleCell);
      row.appendChild(actionCell);
  
      tableBody.appendChild(row);
    });
  }
  
  // Fetch users and render data
  fetchUsers()
    .then(users => {
      renderUserData(users);
    })
    .catch(error => {
      console.error('Error rendering user data:', error);
    });


  </script>
</body>
</html>